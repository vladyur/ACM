\documentclass[a4paper,12pt]{article}

\input{AMV_Preamble.tex}

\newcommand{\prob}[1]{\mathbb{P}\left\{#1\right\}}
\newcommand{\expected}[1]{\mathbb{E}\left\{#1\right\}}

\begin{document}
	
	\thispagestyle{firstpage}
	
	\begin{center}
		\textbf{\Large{Алгоритмы и модели вычислений. \\ Домашнее задание № 8}}
	\end{center}
	
\begin{tasknum}{1}
Подбрасываем <<честную>> монету $10$ раз. Подсчитайте вероятности следующих событий:
\begin{enumerate}
\item (1/6 балла)  число выпавших <<орлов>>  равно числу <<решек>>;

\item (1/6 балла)  выпало больше <<орлов>>  чем <<решек>>;

\item (1/6 балла) при $i=1,\dots,5$ одинаковы результаты $i$-го и $11-i$-го бросаний;

\item (1/2 балла) <<орел>> выпал не менее четырех раз подряд.

\end{enumerate} 
\end{tasknum}

\begin{solution}
	Будем задавать последовательности бросков последовательностями из 0 и 1, причём число 1 на $i$-м месте будет означать, что на $i$-м броске монетки выпал <<орёл>> (соответственно, 0~---~что <<решка>>). 
	\begin{enumerate}
		\item Количество таких последовательностей из 10 элементов, в которых ровно 5 единиц, равняется $C_{10}^5$, всего же последовательностей из 10 элементов $2^{10}$. Таким образом, вероятность того, что  число выпавших <<орлов>>  равно числу <<решек>>, равняется $\dfrac{C_{10}^5}{2^{10}}$
		
		\item Аналогично предыдущему пункту, только вместо ситуации с 5 единицами смотрим на количество последовательностей с 6, 7, 8, 9, 10: таких $C_{10}^6, C_{10}^7, C_{10}^8, C_{10}^9, C_{10}^{10}$ соответственно. Таким образом, вероятность того, что  число выпавших <<орлов>>  больше числа <<решек>>, равняется $\dfrac{C_{10}^6 + C_{10}^7 + C_{10}^8 + C_{10}^9 + C_{10}^{10}}{2^{10}}$.
		
		\item Количество таких последовательностей из 10 элементов, в которых при $i=1,\dots,5$ элементы $i$ и $11-i$ совпадают, равняется $2^5$~---~для каждой из пар выбирается 0 или 1. Таким образом, вероятность того, что при $i=1,\dots,5$ одинаковы результаты $i$-го и $11-i$-го бросаний равняется $\dfrac{2^5}{2^{10}} = \dfrac{1}{2^5} = \dfrac{1}{32}$
		
		\item Рассмотрим последовательности, в которых есть не менее 4х единиц подряд: будем искать ряд 1111 и смотреть на его вхождение: если последовательность начинается с этого ряда, то оставшиеся элементы выбираются $2^6$ способами. Если последовательность не начинается с этого ряда, то имеем 6 позиций его поставить и $2^5$ способов выбрать остальные элементы. То есть итого получаем $2^6 + 6\cdot 2^5$ таких последовательностей. Однако надо заметить, что они пересекаются: последовательности 1111011110, 1111011111 и 1111001111, 1111101111 учитываются как в первом, так и во втором слагаемом нашей суммы; последовательность 0111101111 учитывается дважды во втором слагаемом. Таким образом всего искомых последовательностей $2^6 + 6\cdot 2^5 - 5 = 64 + 6\cdot 32 - 5 = 251$. И тогда вероятность того, что <<орел>> выпал не менее четырех раз подряд равняется $\dfrac{251}{2^{10}} = \dfrac{251}{1024}.$
\end{enumerate}	
\end{solution}

\newpage

\begin{tasknum}{2}
	\begin{enumerate}
	\item Вычислите условную вероятность, что при бросаний двух игральных костей на первой выпало шесть, если сумма равна семи.
	
	\item При двух бросках игральной кости выпало $X_1$ и $X_2$, соответственно. Вычислите $\mathbb{E}\{\max\{X_1,X_2\}\} + \mathbb{E}\{\min\{X_1,X_2\}\}$.
	
	\item Покажите, что из попарной независимости случайных величин не следует независимость в совокупности. Приведите контрпример.
	
	\item Независимы ли события: <<при броске кубика выпало четное число>> и <<при броске кубика выпало число, кратное трём>>?
	
	\item Найти вероятность, что случайно выбранный граф на $n$ вершинах является простым циклом; найти её предел при $n\rightarrow \infty$.
\end{enumerate}
\end{tasknum}

\begin{solution}
	\begin{enumerate}
		\item $\prob{A|B} = \dfrac{\prob{A \cap B}}{\prob{B}} = \dfrac{\prob{\text{на 1й кости выпало 6, сумма равна 7}}}{\prob{\text{сумма равна 7}}}$;
		
		$\dfrac{\prob{\text{на 1й кости выпало 6, сумма равна 7}}}{\prob{\text{сумма равна 7}}} = \dfrac{\#\{\text{на 1й кости выпало 6, сумма равна 7}\}}{\#\{\text{сумма равна 7}\}}$. 
		
		$\#\{\text{на 1й кости выпало 6, сумма равна 7}\} = 1$ (на 1й выпадает 6, на 2й 1);
		
		$\#\{\text{сумма равна 7}\} = 6$ (возможны варианты 1-6, 2-5, 3-4, 4-3, 5-2, 6-1).
		
		Таким образом, искомая вероятность $\prob{A|B} = \dfrac{1}{6}$
		
		\item Так как матожидание линейно, то 
		
		$\expected{\max\{X_1,X_2\}} + \expected{\min\{X_1,X_2\}} = \expected{\max\{X_1, X_2\} + \min\{X_1, X_2\}} = \expected{X_1 + X_2} = 2 \expected{X_1} = 2 \cdot \left(\dfrac{1}{6} \cdot (1 + 2 + 3 + 4 + 5 + 6)\right) = 2 \cdot 3.5 = 7$
		
		\item Возьмём монетку, на которой выпадает либо $0$, либо $1$ (причём с одинаковой вероятностью), бросим её 2 раза. Тогда пространство исходов $\Omega = \{w_1, w_2, w_3, w_4\} = \{00, 01, 10, 11\}, \prob{w_i} = \dfrac{1}{4} \ \ \forall i \in \{1, 2, 3, 4\}$. Случайные величины $\xi, \eta$ определим как $\xi(w_i) = w_i[0]; \eta(w_i) = w_i[1]$ (такая запись тут подразумевает, что $\xi$ равняется первой цифре исхода, а $\eta$~---~второй). А случайную величину $\zeta$ как $\zeta(w_i) = (\xi(w_i) \equiv \eta(w_i))$, то есть $\zeta$ показывает, выпали ла ли монетка дважды одной и той же стороной.
		
		Тогда эти случайные величины попарно независимы: рассматриваем события
		
		$A = \xi^{-1}(0) = \{w_1, w_2\}; B = \xi^{-1}(1) = \{w_3, w_4\}; C = \eta^{-1}(0) = \{w_1, w_3\}; D = \eta^{-1}(1) = \{w_2, w_4\}; E = \zeta^{-1}(0) = \{w_2, w_3\}; F = \zeta^{-1}(1) = \{w_1, w_4\}$
		
		$\dfrac{1}{2} = \prob{A} = \prob{B} = \prob{C} = \prob{D} = \prob{E} = \prob{F}$
		
		$\dfrac{1}{4} = \prob{A \cap C} = \prob{A \cap D} = \prob{A \cap E} = \prob{A \cap F} = \prob{B \cap C} = \prob{B \cap D} = \prob{B \cap E} = \prob{B \cap F} = \prob{C \cap E} = \prob{C \cap F} = \prob{D \cap E} = \prob{D \cap F}$
		
		$\dfrac{1}{4} = \prob{A} \cdot \prob{C} = \prob{A} \cdot \prob{D} = \ldots = \prob{D} \cdot \prob{F}$
		
		Таким образом случайные величины $\xi, \eta, \zeta$ действительно являются попарно независимыми. Покажем, что, однако, они не являются независимыми в совокупности: 
		
		$\prob{A \cap C \cap E} = \prob{\emptyset} = 0 \neq \dfrac{1}{8} = \prob{A}\cdot \prob{C}\cdot \prob{E}$
		
		\item Пусть $A$ = <<при броске кубика выпало четное число>>, $B$ = <<при броске кубика выпало число, кратное трём>>. Тогда $A = \{w_2, w_4, w_6\}, B = \{w_3, w_6\}$.
		
		$\prob{A \cap B} = \prob{\{w_6\}} = \dfrac{1}{6} = \dfrac{3}{6} \cdot \dfrac{2}{6} = \prob{A} \cdot \prob{B} \Ra$ события $A, B$ действительно независимы.
		
		\item Всего последовательностей из $n$ вершин $n!$, но при этом есть $n$ циклических сдвигов (и соответствующие им простые циклы совпадают) и также при ревёрсе последовательности простой цикл тоже не меняется. Таким образом мы должны разделить $n!$ на $2n$ и, итого получим, что есть всего $\dfrac{(n-1)!}{2}$ простых циклов на $n$ вершинах.
		
		Всего различных рёбер в графе на $n$ вершинах $C_n^2 = \dfrac{n(n-1)}{2} \Ra$ всего различных графов на $n$ вершинах $2^{\frac{n(n-1)}{2}}$ (для каждой пары вершин мы выбираем, проводить ребро или нет).
		
		Таким образом, вероятность того, что случайно выбранный граф на $n$ вершинах является простым циклом есть $\dfrac{(n-1)!}{2^{\frac{n(n-1)}{2} + 1}} \longrightarrow 0$ при $n \ra \inf$.
	\end{enumerate}
\end{solution}

\vspace{5mm}

\begin{tasknum}{3}
	(ВТФ) Две урны содержат одинаковое количество шаров. Шары окрашены в белый и черный цвета. Из каждой урны вынимают по $n$ шаров с возвращением, где $n \geq 3$. Найдите $n$ и <<состав>> каждой урны, если вероятность того, что все шары, взятые из первой урны, белые, равна вероятности того, что все шары, взятые из второй урны, либо белые, либо черные.
\end{tasknum}

\begin{solution}
	Пусть $b_1, b_2$~---~количество белых шаров в 1й и 2й урнах соответственно, $m$~---~количество шаров в каждой из урн (одинаково по условию). Тогда $p_1 = \dfrac{b_1}{m}, p_2 = \dfrac{b_2}{m}$~---~вероятности вытащить белый шар из 1й и 2й урн соответственно.
	
	Тогда: $\prob{\text{Все шары, вынутые из 1й урны белые}} = \prob{A} = p_1^n$
	
	$\prob{\text{Либо все шары, вынутые из 2й урны белые, либо все чёрные}} = \prob{B} = p_2^n + (1-p_2)^n$
	
	По условию $\prob{A} = \prob{B} \Ra \left(\dfrac{b_1}{m}\right)^n = \left(\dfrac{b_2}{m}\right)^n + \left(\dfrac{m - b_2}{m}\right)^n$
	
	Таким образом получаем уравнение $b_1^n = b_2^n + (m-b_2)^n, n\ge 3$~---~неразрешимо в ненулевых целых числах по Великой теореме Ферма $\Ra$ по крайней мере одно из чисел обращается в 0.
	
	Заметим, что  $b_2^n + (m-b_2)^n > 0$, так как $m \ge b_2^n, m\ne 0$, то есть $b_1 \neq 0$ и остаются лишь 2 возможных варианта: \begin{itemize}
		\item $b_2 = 0 \Ra b_1 = m$, при этом $n$~---~любое (то есть первая урна состоит полностью из белых шаров, а вторая полностью из чёрных).
		\item $(m-b_2)=0 \Ra b_2 = m, b_1 = m$, при этом $n$~---~любое (то есть первая урна состоит полностью из белых шаров, равно как и вторая; чёрных шаров в урнах нет в принципе).
	\end{itemize}
\end{solution}

\begin{tasknum}{4}
	Симметричную монетку бросают неограниченное число раз. Какая из последовательностей встретится раньше с большей вероятностью: РОР или РРО?
\end{tasknum}

\begin{solution}
	Рассмотрим последовательность в алфавите $\Sigma = \{P, O\}$ и найдём, какая из подпоследовательностей $u=$ РОР или $v=$ РРО встречается первой с большей вероятностью. $u[1] = v[1] = P$, обе подпоследовательности начинаются с Р, поэтому не будем обращать внимание на ведущие О и обратимся к первому вхождению Р: после него в $u$ осталось добрать ОР, в $v$~---~РО, рассмотрим следующий символ последовательности.
	
	С вероятностью $\dfrac{1}{2}$ это Р. Заметим, что в этом случае уже можно сказать, что $v$ встретится раньше: в $u$ осталось добрать ОР, в $v$~---~О, то есть если следующим входит О, то $v$ уже встретилась раньше, а иначе мы остаёмся в ровно этой же позиции. Таким образом, выход из этого случая ровно один~---~$v=$ РРО встретится раньше.
	
	Таким образом мы уже поняли, что $v$ встречается раньше с вероятностью $\ge \dfrac{1}{2}$, а тогда $u$ встречается раньше с вероятностью $\le \dfrac{1}{2}$. Предъявим последовательность, которая не удовлетворяет предыдущему пункту, но после которой всё равно $v$ снова встретится раньше и таким образом докажем, что вероятность $v$ встретиться раньше строго больше, нежели у $u$.
	
	Выпадает О (чтобы не попасть под условия первого пункта), после чего в $u$ осталось добрать Р, в $v$~---~РРО, но тогда возьмём ещё О (тем самым в $u$ и $v$ снова надо добрать начальные РОР и РРО), после чего просто берём РРО и получаем, что $v$ снова встретилось раньше.
	
	Таким образом мы получили, что $v$ встречается раньше $u$ с вероятностью $> \dfrac{1}{2}$, то есть последовательность РОР встречается раньше с большей вероятностью, нежели РРО.
	
\end{solution}

\begin{tasknum}{5}
	\begin{enumerate}
		\item Найти мат. ожидание числа простых циклов длины $r$ в случайном графе на $n$ вершинах. Любое из $C_n^2$ рёбер генерируется независимо от других с вероятностью $p$.
	
		\item Найти мат. ожидание числа простых циклов длины $r$ в случайной перестановке $n$ элементов в предположении, что все перестановки $\pi \in S_n$ равновероятны.
	\end{enumerate}
\end{tasknum}

\begin{solution}
	\begin{enumerate}
		\item Пусть $\xi$~---~искомое матожидание, $\xi = \displaystyle\sum_{i=1}^N \xi_i$, где $\xi_i = 1 \LRa$ $i$-й простой цикл присутствует в графе (иначе $\xi_i = 0$).
		
		Так как количество способов выбрать $r$ вершин из $n$ есть $C_n^r$, а количество простых циклов на $r$ вершинах было посчитано в задаче номер 2, оно равняется $\dfrac{(r-1)!}{2}$, то $N = C_n^r \cdot \dfrac{(r-1)!}{2}$.
		
		Тогда в силу линейности матожидания $\expected{\xi} = \displaystyle\sum_{i=1}^N \expected{\xi_i} = N \cdot \prob{\text{простой цикл был сгенерирован}} = N \cdot p^r = C_n^r \cdot p^r \cdot \dfrac{(r-1)!}{2}$.
		
		\item  Пусть $\xi$~---~искомое матожидание, $\xi = \displaystyle\sum_{i=1}^N \xi_i$, где $\xi_i = 1 \LRa$ $i$-й простой цикл присутствует в перестановке (иначе $\xi_i = 0$).
		
		Так как количество способов выбрать $r$ элементов из $n$ есть $C_n^r$, 
		а количество простых циклов на $r$ элементах равняется $(r-1)!$ (аналогично прошлой задаче, только теперь порядок важен, поэтому мы не делим на 2), тогда $N = C_n^r \cdot (r-1)! = \dfrac{n!}{r! \cdot (n-r)!} \cdot (r-1)! = \dfrac{n!}{r \cdot (n-r)!}$.
		
		Так как всего перестановок $n!$, $r$ элементов в цикле фиксируются, то матожидание каждого цикла находится как $\expected{\xi_i} = \dfrac{(n-r)!}{n!}$
		
		Тогда в силу линейности матожидания $\expected{\xi} = \displaystyle\sum_{i=1}^N \expected{\xi_i} = N \cdot \expected{\xi_i} = \dfrac{n!}{r \cdot (n-r)!} \cdot \dfrac{(n-r)!}{n!} = \dfrac{1}{r}$.
	\end{enumerate}
\end{solution}

\vspace{5mm}

\begin{tasknum}{6}
	\begin{enumerate}
		\item Имеется генератор случайных битов, выдающий $0$ и $1$ с вероятностью $1/2$. Предложите алгоритм, использующий этот генератор и выдающий $0$ с вероятностью $1/3$ и $1$ с вероятностью $2/3$. Оцените его время работы в лучшем и в худшем случае.
		
		\item Обратно: из генератора $(1/3; 2/3)$ получите $(1/2)$.
	\end{enumerate}
\end{tasknum}

\begin{solution}
	\begin{enumerate}
		\item Прогоним исходный генератор 2 раза, будем интерпретировать его результаты следующим образом: $00\longrightarrow 0, 10 \longrightarrow 1, 11 \longrightarrow 1$, причём значению 01 не будем сопоставлять ничего~---~в таком случае наш алгоритм просто не завершит свою работу (так что время работы неограниченно, в худшем случае алгоритм не останавливается вообще)
		
		Исходный генератор выдавал биты равновероятно, так что значения 00, 10 и 11 также равновероятны, а поэтому наш алгоритм выдаёт $0$ с вероятностью $1/3$ и $1$ с вероятностью $2/3$.
		
		В лучшем случае алгоритм работает за 2 прогона нашего исходного генератора.
		
		\item Прогоним исходный генератор 2 раза, будем интерпретировать его результаты следующим образом: $01\longrightarrow 0, 10 \longrightarrow 1$, причём значениям 00 и 11 не будем сопоставлять ничего~---~в таком случае наш алгоритм просто не завершит свою работу (так что время работы неограниченно, в худшем случае алгоритм не останавливается вообще)
		
		Исходный генератор выдавал бит 0 с вероятностью $1/3$, $1$ с вероятностью $2/3$. Таким образом $\prob{01} = \prob{0} \cdot \prob{1} = \prob{1} \cdot \prob{0} = \prob{10}$, так что наш алгоритм выдаёт 0 и 1 с одинаковой вероятностью.
		
		В лучшем случае алгоритм работает за 2 прогона нашего исходного генератора.
	\end{enumerate}
\end{solution}

\begin{tasknum}{7}
	\begin{enumerate}
		\item Найти мат. ожидание количества неподвижных элементов в случайно выбранной из $S_n$ перестановке.   
		
		\item Найти математическое ожидание числа бросаний кости до первого выпадения двух шестерок подряд. 
	\end{enumerate}
\end{tasknum}

\begin{solution}
	\begin{enumerate}
		\item Пусть $\xi$~---~искомое матожидание, $\xi = \displaystyle\sum_{i=1}^n \xi_i$, где $\xi_i = 1 \LRa$ $n$-й элемент является неподвижным (иначе $\xi_i = 0$).
		
		Так как всего перестановок $n!$, $1$ неподвижный элемент фиксируются, то матожидание того, что $i$-й элемент неподвижен находится как $\expected{\xi_i} = \dfrac{(n-1)!}{n!} = \dfrac{1}{n}$.
		
		Тогда в силу линейности матожидания $\expected{\xi} = \displaystyle\sum_{i=1}^n \expected{\xi_i} = n \cdot \expected{\xi_i} = n \cdot \dfrac{1}{n} = 1$.
	\end{enumerate}
\end{solution}


\begin{tasknum}{8}
	В экзаменационной программе обычного экзамена $25$ билетов, из которых $5$ простые, а вытянув любой из остальных, всякий студент точно завалит экзамен. Подряд заходят два студента. Какой из них с большей вероятностью вытянет простой билет?
\end{tasknum}

\begin{solution}
	Первый студент вытягивает простой билет с вероятностью $\prob{easy1} = \dfrac{5}{25} = \dfrac{1}{5}$. Посчитаем по формуле полной вероятности для второго студента:
	
	$\prob{easy2} = \prob{easy2 | hard 1} \cdot \prob{hard1} + \prob{easy2 | easy 1} \cdot \prob{easy1} =  \dfrac{5}{24} \cdot \dfrac{20}{25} + \dfrac{4}{24} \cdot \dfrac{5}{25} = \dfrac{1}{5} \hm{=} \prob{easy1}$
	
	Таким образом оба студента вытягивают простой билет с равной вероятностью.
\end{solution}


\end{document}