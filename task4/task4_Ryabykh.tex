\documentclass[a4paper,12pt]{article}

\input{AMV_Preamble.tex}

\begin{document}
	
	\thispagestyle{firstpage}
	
	\begin{center}
		\textbf{\Large{Алгоритмы и модели вычислений. \\ Домашнее задание № 4}}
	\end{center}
	
\begin{tasknum}{1}
	Постройте NP-сертификат простоты числа $p = 3911$, $g = 13$. Простыми в рекурсивном построении считаются только числа $2$, $3$, $5$.
\end{tasknum}

\begin{solution}
	
	$g$ --- первообразный корень, является NP-сертификатом простоты числа $p = 3911$.
	
	$g^{p-1} = 13^{3910} \underset{3911}{\equiv} 1$ ~---~ по малой теореме Ферма.
	
	Решающей структурой будет дерево, в корне которого находится само число $p$ со своим сертификатом $g$, а в его детях ~---~ делители числа $p-1$ и их сертификаты соответственно (и так далее по рекурсии).
	
	$p-1 = 3910 = 23 \cdot 17 \cdot 5 \cdot 2$, раскладываем дальше:
	
	\begin{itemize}
		\item $2$, $5$ считаем простыми по условию задачи.
		\item $17$ имеет своим сертификатом $3$, $17-1=16=2^4 \Ra 17$ ~---~ простое.
		\item $23$ имеет своим сертификатом $5$, $23-1=22=11 \cdot 2$, таким образом либо $23$ и $11$ просты одновременно, либо одновременно являются составными.
		
		\begin{itemize}
			\item $11$ имеет своим сертификатом $2$: $11-1=10 = 5 \cdot 2 \Ra 11$ ~---~ простое.
		\end{itemize}
		
	\end{itemize}
	
	Таким образом, $p=3911$ является простым.
	
\end{solution}

\begin{tasknum}{2}
	Найдите $\Theta$-асимптотику суммы $\displaystyle\sum_{k=1}^n \sqrt{k}$, оценив её с помощью интеграла $\displaystyle\int_1^n \sqrt{x}dx$ сверху и снизу. Выведите аналогичную формулу для асимптотики $\displaystyle\sum_{k=1}^n k^\alpha$ для $\alpha > 0$.
\end{tasknum}

\begin{solution}
	
	
	$$\displaystyle\int_0^n \sqrt{x}dx \le \displaystyle\sum_{k=1}^n \displaystyle\int_{k-1}^{k} \sqrt{x}dx \le \displaystyle\sum_{k=1}^n \displaystyle\int_{k-1}^{k} \sqrt{k}dx = \displaystyle\sum_{k=1}^n \sqrt{k} = \displaystyle\sum_{k=1}^n \displaystyle\int_{k}^{k+1} \sqrt{k}dx \le \displaystyle\sum_{k=1}^n \displaystyle\int_{k}^{k+1} \sqrt{x}dx \le \displaystyle\int_1^{n+1} \sqrt{x}dx$$
	
	Таким образом получаем, что $\displaystyle\int_0^n \sqrt{x}dx \le \displaystyle\sum_{k=1}^n \sqrt{k} \le \displaystyle\int_1^{n+1} \sqrt{x}dx$
	
	То есть $\dfrac{2}{3} \cdot n^{\frac{3}{2}} \le \displaystyle\sum_{k=1}^n \sqrt{k} \le \dfrac{2}{3} \cdot ((n+1)^{\frac{3}{2}} - 1)$, таким образом $\displaystyle\sum_{k=1}^n \sqrt{k} = \Theta(n^{\frac{3}{2}})$
	
	Так как $\displaystyle\sum_{k=1}^n \sqrt{k} = \displaystyle\sum_{k=1}^n k^{\frac{1}{2}}$, проведём теперь аналогичные действия для произвольного $\alpha > 0$:
	
	$$\displaystyle\int_0^n x^{\alpha}dx \le \displaystyle\sum_{k=1}^n \displaystyle\int_{k-1}^{k} x^{\alpha}dx \le \displaystyle\sum_{k=1}^n \displaystyle\int_{k-1}^{k} k^{\alpha}dx = \displaystyle\sum_{k=1}^n k^{\alpha} = \displaystyle\sum_{k=1}^n \displaystyle\int_{k}^{k+1} k^{\alpha}dx \le \displaystyle\sum_{k=1}^n \displaystyle\int_{k}^{k+1} x^{\alpha}dx \le \displaystyle\int_1^{n+1} x^{\alpha}dx$$
	
	Таким образом получаем, что $\displaystyle\int_0^n x^{\alpha}dx \le \displaystyle\sum_{k=1}^n k^{\alpha} \le \displaystyle\int_1^{n+1} x^{\alpha}dx$
	
	То есть $\dfrac{1}{\alpha + 1} \cdot n^{\alpha + 1} \le \displaystyle\sum_{k=1}^n \sqrt{k} \le \dfrac{1}{\alpha + 1} \cdot ((n+1)^{\alpha + 1} - 1)$, таким образом $\displaystyle\sum_{k=1}^n k^{\alpha} = \Theta(n^{\alpha + 1})$
	
\end{solution}

\vspace{5mm}

\begin{tasknum}{3}
	а) Верно ли что язык $5$-ДНФ-Л является полиномиально полным в $\coNP$?
	
	Язык $5$-ДНФ-Л состоит из всех формул в дизъюнктивной нормальной форме, принимающих истинное значение при каких-то значениях переменных, в каждый конъюнкт которых входит не более пяти переменных. 
	
	б) Верно ли что язык $5$-КНФ-Л является полиномиально полным в $\mathcal{NP}$?
	
	Язык $5$-КНФ-Л состоит из всех формул в конъюнктивной нормальной форме, принимающих  ложное значение при каких-то значениях переменных, в каждый дизъюнкт которых входит не более пяти переменных.
	
	\noindent {\em Можно использовать гипотезы $\mathcal{P}\neq\mathcal{NP}$ и $\mathcal{NP}\neq \coNP$.}
	
	\smallskip
	
	в) Расставьте и обоснуйте $\mathcal{P}$, $\mathcal{NP}-complete$, $co-\mathcal{NP}-complete$: 
	\begin{center}
		\begin{tabular}{|c|c|c|}
			\hline
			& Выполнимость & Тавтологичность \\
			\hline
			КНФ &  &  \\
			\hline
			ДНФ  &   &  \\
			\hline
		\end{tabular}
	\end{center}
	
	Под выполнимостью понимается задача проверки наличия набора значений переменных, на котором формула равна $1$. Под тавтологичностью понимается задача проверки свойства формулы принимать значение $1$ на всех наборах.
\end{tasknum}

\begin{solution}
	
	\begin{enumerate}
		\item Пусть $\ol{A} =$ $5$-ДНФ-Л. Допустим, что $\ol{A}$ ~---~ полиномиально полный в $\coNP$, то есть $\forall L \in \NP \vyp \ol{L} \polysv \ol{A}$
		
		Рассмотрим язык $\ol{\ol{A}} = A$. $A \in \NP$, так как $\ol{A} \in \coNP$ по предположению. $A$ ~---~ язык, содержащий либо не ДНФ, либо те ДНФ, в которых есть конъюнкт с не менее 6 литералами, либо невыполнимые 5-ДНФ. Все эти 3 кластера мы легко можем проверить за полиномиальное время: первые два очевидно, а для проверки невыполнимости будем пользоваться следующим. ДНФ невыполнима $\LRa$ каждый из конъюнктов тождественно ложен, то есть в каждом конъюнкте присутствует некоторый литерал со своим отрицанием ~---~ мы можем легко это проверить для каждого из конъюнктов, которых в свою очередь $\le n$, где $n$ ~---~ длина формулы, то есть по сути длина входа. Таким образом выходит, что мы за полиномиальное время детерминированно проверяем принадлежность входа к $A$, то есть таким образом $A \in \P$. А это означает, что $\ol{A} \in \P$, а следовательно, так как $\forall L \in \NP \vyp \ol{L} \polysv \ol{A}$, то получаем, что $\forall L \in \NP \vyp \ol{L} \in \P \vyp \ol{\ol{L}}=L \in \P \Ra \P = \NP$, что неверно по гипотезе. Таким образом мы пришли к противоречию, так что язык $\ol{A} =$ $5$-ДНФ-Л не является полиномиально полным в $\coNP$.
		
		\item Пусть $A =$ $5$-КНФ-Л. Формула в КНФ принимает ложное значение $\LRa$ существует дизъюнкт, обращающийся в 0, то есть все литералы в дизъюнкте должны обратиться в 0. Соответственно, мы можем подобрать подходящий набор переменных тогда и только тогда, когда существует дизъюнкт, в котором не находятся одновременно литерал со своим отрицанием. Аналогично прошлому пункту, мы можем легко проверить наличие такого дизъюнкта, причём, так как всего их $\le n$, где $n$ ~---~ длина формулы, то есть по сути длина входа, выходит, что мы за полиномиальное время детерминированно проверяем принадлежность входа к $A$, то есть таким образом $A \in \P$. Поэтому $A$ не может быть $\NP$-полным, так как иначе каждый язык из $\NP$ сводился бы к $A \in P$, то есть язык сам лежал бы в $\P$, и тогда мы бы получили $\P = \NP$, что неверно по гипотезе.
		
		\item 
		
		\begin{enumerate}
			
			\item КНФ тавтологична тогда и только тогда, когда каждый из её дизъюнктов обращается в 1 на любом наборе переменных, то есть на любом наборе переменных невозможно ни один из дизъюнктов обратить в 0. Это же выполняется тогда и только тогда, когда каждый из дизъюнктов содержит некоторый литерал со своим отрицанием. Соответственно, проверить это мы можем за $O(m^2) = O(n^2)$, где $m \le n$ ~---~ длина наибольшего из дизъюнктов, $n$ ~---~ длина всей формулы. Всего таких дизъюнктов $\le n$, поэтому итоговая сложность алгоритма $O(n^3)$ ~---~ полиномиальна, так что проверка тавтологичности КНФ лежит в $\P$.
			
			\item Аналогично с выполнимостью ДНФ, только теперь нам надо проверять, что существует конъюнкт, в котором не содержится некоторого литерала с его отрицанием. Также это можно выполнить за $O(n^3)$, так что проверка выполнимости ДНФ лежит в $\P$.
			
			\item Язык выполнимых КНФ есть SAT ~---~ фундаментальный пример $\NP_c$ языка, полнота которого в $\NP$ следует из теоремы Кука-Левина.
			
			\item ДНФ тавтологична $\LRa$ её отрицание является невыполнимой КНФ. Задача о выполнимости КНФ является $\NP$-полной, поэтому задача о её невыполнимости является $\coNP$-полной.
			
		\end{enumerate}
		
		Таким образом, табличка примет следующий вид:
		 \begin{center}
			\begin{tabular}{|c|c|c|}
				\hline
				& Выполнимость & Тавтологичность \\
				\hline
				КНФ & $\NP_c$ & $\P$ \\
				\hline
				ДНФ  & $\P$  &  $\coNP_c$ \\
				\hline
			\end{tabular}
		\end{center}
		
	\end{enumerate}
	
	
\end{solution}

\end{document}