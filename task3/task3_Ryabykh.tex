\documentclass[a4paper,12pt]{article}

\input{AMV_Preamble.tex}

\begin{document}
	
	\thispagestyle{firstpage}
	
	\begin{center}
		\textbf{\Large{Алгоритмы и модели вычислений. \\ Домашнее задание № 3}}
	\end{center}
	
\begin{tasknum}{1}
	Постройте полиномиальную сводимость языка 3-ВЫПОЛНИМОСТЬ (3-SAT) (выполнимые КНФ, в каждом дизъюнкте не более 3 литералов) к языку РОВНО-3-ВЫПОЛНИМОСТЬ (выполнимые КНФ, в каждом дизъюнкте в точности $3$ литерала).
\end{tasknum}

\begin{solution}
	
	Необходимо построить сводимость по Карпу 3-SAT $\polysv$ Exactly-3-SAT. 
	
	Пусть $A$ ~---~ формула, представленная в виде КНФ, в каждом конъюнкте которой не более 3 литералов (если мы на вход получили что-то другого вида, тогда, очевидно, вход не будет лежать ни в 3-SAT, ни в Exactly-3-SAT и наша функция $f$ будет работать как тождественная). Если же на вход действительно поступила формула $A$, то преобразуем каждый её дизъюнкт так, чтобы получить в нём в точности $3$ литерала: просто продублируем первый литерал столько раз, чтобы <<добить>> данный дизъюнкт до 3 литералов. Например, дизъюнкт ($a \vee \ol{b}$) преобразуется в ($a \vee \ol{b} \vee a$), а дизъюнкт ($\ol{c}$) ~---~ в ($\ol{c} \vee \ol{c} \vee \ol{c}$). Очевидно, что $(x) \LRa (x \vee x)$, поэтому на выполнимость формулы данное преобразование никак не влияет. Формула $A$ преобразуется к $f(A)$ за полиномиальное от $|A|$ время, так как мы просто добавляем к входу $\le 4 \cdot |A|$ символов (максимально по 2 литерала и 2 знака дизъюнкции для каждого дизъюнкта $D$ (тут, в свою очередь, использовано, что $|D| \le |A|$)), поэтому описанная функция $f$ полиномиально сводит язык 3-SAT к языку Exactly-3-SAT.
	
\end{solution}

\begin{tasknum}{2}
	Постройте сводимость языка ВЫПОЛНИМОСТЬ (SAT) к языку ПРОТЫКАЮЩЕЕ МНОЖЕСТВО.
\end{tasknum}

\begin{solution}
	
	Описание конструкции см. в приложенном листке. Осталось доказать, что исходная
	КНФ $\phi(x_1, x_2, \ldots, x_n)$ выполнима тогда и только тогда, когда $A_\phi$ имеет протыкающее множество мощности $n$.
	
	\begin{itemize}
		\item $\Ra$: КНФ $\phi(\cdot)$ выполнима $\Ra$ существует набор значений переменных, на котором функция обращается в $1$. Тогда, если в этом наборе $x_i = 1$, то добавим в множество $A$ литерал $x_i$, если же $x_i = 0$, то добавляем в $A$ литерал $\ol{x_i}$ (по этому правилу будем далее отождествлять набор значений переменных и набор значений литералов). Делая так для всех переменных, получаем множество $A$ мощности $n$ такое, что если все литералы, лежащие в этом множестве, обращаются в $1$, то и функция $\phi$ на этом наборе обращается в $1$. 
		
		Покажем, что это множество $A$ и будет являться протыкающим. Действительно, каждое из подмножеств $A_\phi$ вида $A_i = \left\{x_i, \ol{x_i}\right\} \ \forall i \in \ol{1, n}$ будет пересекаться с $A$ по построению, а каждое подмножество вида $A_C$, состоящее из всех входящих в дизъюнкт $C$ литералов, будет пересекаться с $A$ в силу того, что на наборе литералов из $A$ КНФ $\phi$ выполнима, а следовательно каждый из её дизъюнктов обращается в $1$, так что в каждом подмножестве вида $A_C$ есть по крайней мере один литерал, принимающий на этом наборе значение, равное $1$, а по построению множество $A$ как раз и содержит все такие литералы, то есть этот литерал и будет лежать в пересечении $A_C$ с $A$.
		
		\item $\La$: $A_\phi$ имеет протыкающее множество $A$ мощности $n$. $A$ пересекает все подмножества вида $A_i = \left\{x_i, \ol{x_i}\right\} \ \forall i \in \ol{1, n}$, поэтому состоит из литералов всех $n$ переменных. $A$ пересекает все подмножества вида $A_C$, состоящие из всех входящих в дизъюнкт $C$ литералов, так что если рассмотреть набор переменных, на котором все литералы из $A$ обращаются $1$ (имеем право, так как $A$ содержит ровно $n$ литералов от $n$ различных переменных), то на этом наборе сама КНФ $\phi(\cdot)$ обратится в $1$, потому что каждый из дизъюнктов обратится в $1$ в силу того, что на этом наборе переменных он будет содержать по крайней мере один литерал (так как пересечение $A_C$ с $A$ непусто для любого дизъюнкта $C$), обращающийся в $1$.
		
	\end{itemize}
	
	
\end{solution}

\begin{tasknum}{3}
	Постройте сводимость языка 3-ВЫПОЛНИМОСТЬ к языку ВЕРШИННОЕ ПОКРЫТИЕ (VERTEX-COVER).
\end{tasknum}

\begin{solution}
	
	Ранее было доказано, что 3-SAT $\polysv$ Exactly-3-SAT, в этом номере покажем, что Exactly-3-SAT $\polysv$ VERTEX-COVER и тогда получим 3-SAT $\polysv$ VERTEX-COVER по транзитивности.
	
	Описание конструкции см. в приложенном листке. Осталось доказать, что исходная
	КНФ $\phi(x_1, x_2, \ldots, x_n)$ выполнима тогда и только тогда, когда $G_\phi$ имеет вершинное покрытие $V$ мощности $n+2m$, где $m$ ~---~ количество дизъюнктов.
	
	\begin{itemize}
		\item $\Ra$: сначала определимся с выбором $n$ литеральных вершин. КНФ $\phi(\cdot)$ выполнима $\Ra$ существует набор значений переменных, на котором функция обращается в $1$. Тогда, если в этом наборе $x_i = 1$, то добавим в множество вершин $V$ литеральную вершину $x_i$, если же $x_i = 0$, то добавляем в $V$ литеральную вершину $\ol{x_i}$. Таким образом мы гарантируем, что в каждой паре литеральных вершин будет одна вершина, лежащая в $V$, а следовательно, рёбра между литеральными вершинами будут захвачены нашим вершинным покрытием $V$.
		
		 Теперь, так как КНФ $\phi$ выполнима (а следовательно каждый из её дизъюнктов обращается в $1$), в каждой из троек дизъюнктных вершин есть по крайней мере один литерал, принимающий на этом наборе значение, равное $1$ ~---~ он по построению соединён с уже лежащей в $V$ соответствующей литеральной вершиной, так что добавим в $V$ не эту дизъюнктную вершину, а другие две дизъюнктные, смежные ей. Таким образом мы гарантируем, что во-первых, из каждой тройки дизъюнктных вершин две будут лежать в $V$, а следовательно, покрытие захватит все рёбра каждой из дизъюнктных троек; а во-вторых, что две другие вершины, литералы которых могут быть не равными $1$, будут соединены с соответствующими им литеральными вершинами (иначе могли бы остаться непокрытые рёбра). Получаем, что наше вершинное покрытие $V$ захватит последние оставшиеся рёбра между невзятыми ранее литеральными вершинами и соответствующими им дизъюнктивными.
		 
		 \item $\La$: $V$ --- вершинное покрытие $\Ra$ оно содержит как минимум одну литеральную вершину в каждой паре соответствующих (иначе ребро между ними не было бы покрыто). Таким образом оно содержит $\ge n$ литеральных вершин. Заметим теперь, что $V$ содержит как минимум две дизъюнктных вершины в каждой тройке соответствующих (иначе в этом треугольнике нашлось бы непокрытое ребро). Таким образом оно содержит $\ge 2m$ дизъюнктных вершин. По условию же $|V| = n + 2m$, следовательно в вершинном покрытии находятся ровно $n$ литеральных и ровно $2m$ дизъюнктных вершин.
		 
		 Возьмём набор литералов, соответствующий набору литеральных вершин $V$. На этом наборе наша функция $\phi$ и будет обращаться в $1$ (если в $V$ лежит литеральная вершина $x_i$, то в нашем наборе переменных берём $x_i = 1$, если же в $V$ лежит $\ol{x_i}$ ~---~ берём $x_i = 0$). Докажем это от противного: допустим, что на этом наборе существует дизъюнкт, обращающийся в $0$, то есть существует тройка дизъюнктных вершин, все 3 литерала которой обращаются в $0$. Такого быть не может, так как в $V$ лежат ровно 2 дизъюнктные вершины из каждой тройки. То есть в этой тройке существует вершина, литерал которой обращается в 0 и которая не лежит в $V$ сама по себе ~---~ это противоречие к тому, что $V$ является вершинным покрытием, потому что ребро между этой вершиной и соответствующей ей литеральной (не лежит в $V$, так как все литералы, соответствующие литеральным вершинам из $V$, обращаются в 1 на этом наборе) не будет покрыто.
		  
	\end{itemize}
	
\end{solution}

\begin{tasknum}{4}
	Постройте сводимость языка РОВНО-3-ВЫПОЛНИМОСТЬ к языку КЛИКА (CLIQUE).
\end{tasknum}

\begin{solution}
	
	Описание конструкции см. в приложенном листке. Осталось доказать, что исходная
	КНФ $\phi(x_1, x_2, \ldots, x_n)$ выполнима тогда и только тогда, когда $G_\phi$ имеет клику размера $m$, где $m$ ~---~ количество дизъюнктов.
	
	\begin{itemize}
		\item $\Ra$: КНФ $\phi(\cdot)$ выполнима $\Ra$ существует набор значений переменных, на котором функция обращается в $1$, то есть на этом наборе в каждом дизъюнкте присутствует литерал, обращающийся в 1. Таким образом мы можем в каждом из дизъюнктов взять такой литерал и соединить их все вместе (такие рёбра есть, так как, очевидно, отвечающие этим литералам переменные, никак не могут быть отрицанием друг друга). Получим искомую клику размера $m$.
		
		\item $\La$: в нашем графе есть клика размера $m$. Так как вершины одного дизъюнкта не смежны между собой, то каждый дизъюнкт в клике представляет не более одной вершины. Всего дизъюнктов $m \Ra$ на самом деле каждый дизъюнкт представлен в клике ровно одной вершиной. Теперь возьмём следующий набор переменных: если в клике есть вершина, отвечающая литералу $x_i$, то в нашем наборе переменных берём $x_i = 1$, если же в клике лежит $\ol{x_i}$ ~---~ берём $x_i = 0$. Если же в клике вообще нет вершины, отвечающей переменной $x_i$ ~---~ положим для определённости $x_i = 1$ (хотя это ни на что не влияет, так как на самом деле $x_i$ ~---~ фиктивная переменная). Таким образом построенный набор переменных задаётся непротиворечиво, так как по условию наличия рёбер между вершинами, не может быть такого, что и литерал $x_i$, и литерал $\ol{x_i}$ присутствуют в клике. На этом наборе КНФ $\phi(\cdot)$ обращается в 1, так как в каждом дизъюнкте присутствует литерал, обращающийся в 1.
	\end{itemize}
	
\end{solution}

\begin{tasknum}{7}
	Покажите, что построенная на семинаре при сводимости 3-CNF к CIRCUIT-SAT формула равновыполнима с исходной. 
\end{tasknum}

\begin{solution}
	
	Докажем, что формула выполнима $\LRa$ выполнима схема:
	
	\begin{itemize}
		\item $\Ra$: формула выполнима $\Ra$ существует набор переменных, на котором все дизъюнкты обращаются в 1 $\Ra$ все эквивалентности верны, а также $y_m = 1$. Но таким образом мы можем <<развернуть>> выражение для $y_m$ через переменные $x_1, x_2, \ldots, x_n$ (мы имеем право так сделать, эти преобразования корректны как раз из-за того, что все эквивалентности выполняются). Таким образом $y_m$ представляется, как формула от $y_m = f(x_1, x_2, \ldots, x_n)$, равновыполнимая с исходной схемой. Таким образом, так как на данном наборе переменных $f(x_1, x_2, \ldots, x_n) = y_m = 1$, то исходная схема также выполнима.
		
		\item $\La$: схема выполнима $\Ra$ существует набор переменных, на котором $y_m = 1$. Таким образом получаем, что в нашей формуле все эквивалентности обращаются в $1$ по построению, а в силу того, что и $y_m=1$, все дизъюнкты обращаются в 1 $\Ra$ сама формула также обращается в $1$.
	\end{itemize}
	
\end{solution}

\end{document}